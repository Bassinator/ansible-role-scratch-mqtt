---
- name: copy extension file
  template:
    src: mqtt_extension_local.js
    dest: /usr/lib/scratch2/scratch_extensions
    mode: 0644

- name: copy extension icon
  copy:
    src: mosquitto_mqtt.png
    dest: /usr/lib/scratch2/scratch_extensions/medialibrarythumbnails/
    mode: 0644

- name: copy example Project 
  copy:
    src: mosquitto_mqtt.png
    dest: /home//
    mode: 0644


- name: add extension to scratch config
  lineinfile:
    path: "/usr/lib/scratch2/scratch_extensions/extensions.json"
    create: true
    insertafter: '^[[]'
    regexp: '^{ "name":"MQTT",'
    line: >
      {
      "name":"MQTT",
      "type":"extension",
      "file":"mqtt_extension_local.js",
      "md5":"mosquitto_mqtt.png",
      "url":"https://github.com/Bassinator/scratch-mqtt-extension",
      "tags":["network"]
      },
